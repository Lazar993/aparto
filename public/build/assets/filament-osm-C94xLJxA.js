var a={debounceDelay:400,minChars:3,init:function(){for(var e=document.querySelectorAll('input[data-osm-autocomplete="true"]'),n=0;n<e.length;n+=1){var t=e[n];a.ensureInputId(t),t.dataset.apartoOsmBound!=="true"&&(t.dataset.apartoOsmBound="true",a.bindAutocomplete(t))}},ensureInputId:function(e){e.id||(e.id="aparto-osm-"+Math.random().toString(36).slice(2))},bindAutocomplete:function(e){var n=null,t=null,o=a.createDropdown(e);e.addEventListener("input",function(){var r=e.value.trim();a.clearDropdown(o),!(r.length<a.minChars)&&(n&&clearTimeout(n),n=setTimeout(function(){t&&t.abort(),t=new AbortController,a.fetchResults(r,t.signal,function(i){a.renderResults(o,e,i)})},a.debounceDelay))}),document.addEventListener("click",function(r){o.contains(r.target)||e.contains(r.target)||a.clearDropdown(o)})},fetchResults:function(e,n,t){var o="/osm/search?q="+encodeURIComponent(e);fetch(o,{headers:{Accept:"application/json"},signal:n}).then(function(r){return r.ok?r.json():[]}).then(function(r){t(Array.isArray(r)?r:[])}).catch(function(){t([])})},renderResults:function(e,n,t){if(t.length){e.style.display="grid";for(var o=0;o<t.length;o+=1)(function(r){var i=document.createElement("button");i.type="button",i.textContent=r.display_name,i.className="aparto-osm-item",i.addEventListener("click",function(){a.applyResult(n,r),a.clearDropdown(e)}),e.appendChild(i)})(t[o])}},applyResult:function(e,n){e.value=n.display_name||e.value,e.dispatchEvent(new Event("input",{bubbles:!0}));var t=a.findCity(n.address||{});a.setInputValue(e.dataset.cityInput,t),a.setInputValue(e.dataset.latInput,n.lat),a.setInputValue(e.dataset.lngInput,n.lon)},findCity:function(e){return e.city||e.town||e.village||e.county||e.state||""},setInputValue:function(e,n){if(!(!e||n===void 0||n===null)){var t=document.getElementById(e);t&&(t.value=n,t.dispatchEvent(new Event("input",{bubbles:!0})))}},createDropdown:function(e){var n=document.querySelector('.aparto-osm-dropdown[data-osm-for="'+e.id+'"]');n&&n.parentNode.removeChild(n);var t=document.createElement("div");return t.className="aparto-osm-dropdown",t.setAttribute("data-osm-for",e.id),t.style.position="absolute",t.style.zIndex="50",t.style.background="#ffffff",t.style.border="1px solid #e5e7eb",t.style.borderRadius="10px",t.style.boxShadow="0 12px 24px rgba(0, 0, 0, 0.08)",t.style.padding="6px",t.style.display="none",t.style.gap="4px",t.style.maxHeight="220px",t.style.overflow="auto",t.style.boxSizing="border-box",document.body.appendChild(t),a.positionDropdown(e,t),window.addEventListener("resize",function(){a.positionDropdown(e,t)}),t},positionDropdown:function(e,n){var t=e.getBoundingClientRect();n.style.width=t.width+"px",n.style.left=t.left+window.scrollX+"px",n.style.top=t.bottom+window.scrollY+"px"},clearDropdown:function(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.style.display="none"},ensureMap:function(e){var n=e.dataset.mapTarget;if(n&&!a.maps[n]){var t=document.getElementById(n);if(t&&!(t.dataset.apartoMapReady==="true"||t._leaflet_id)&&!(!window.L||!window.L.map)){var o=L.map(t).setView([44.8176,20.4633],12);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap contributors"}).addTo(o),t.dataset.apartoMapReady="true",a.maps[n]={map:o,marker:null}}}},updateMap:function(e,n){var t=e.dataset.mapTarget;if(t){var o=a.maps[t];if(o){var r=parseFloat(n.lat),i=parseFloat(n.lon);isNaN(r)||isNaN(i)||(o.marker?o.marker.setLatLng([r,i]):o.marker=L.marker([r,i]).addTo(o.map),o.map.setView([r,i],15))}}},maps:{}};function l(){a.init(),window.Livewire&&typeof window.Livewire.hook=="function"&&window.Livewire.hook("message.processed",function(){a.init()})}document.addEventListener("DOMContentLoaded",function(){l()});
